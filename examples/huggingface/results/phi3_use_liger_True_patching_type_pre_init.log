********** Pre-Init Patching ***********
apply_liger_kernel_to_phi3 args
True False True True True
********** Pre-Init Patching ***********
********** Pre-Init Patching ***********
apply_liger_kernel_to_phi3 args
True False True True True
apply_liger_kernel_to_phi3 args
True False True True True
********** Pre-Init Patching ***********
apply_liger_kernel_to_phi3 args
True False True True True
{'loss': 1.4176, 'grad_norm': 12.636173248291016, 'learning_rate': 6e-06, 'epoch': 0.01, 'num_input_tokens_seen': 217088}
{'loss': 1.3659, 'grad_norm': 11.901530265808105, 'learning_rate': 5.819077862357725e-06, 'epoch': 0.02, 'num_input_tokens_seen': 428032, 'step': 2, 'step_time_sec': 11.42, 'avg_step_time_sec': 11.42, 'time_to_completion_sec': 91.38, 'estimated_total_time_sec': 114.22, 'step_peak_memory_allocated_MB': 38576.72, 'step_peak_memory_reserved_MB': 53290.0, 'total_peak_memory_allocated_MB': 38576.72, 'total_peak_memory_reserved_MB': 53290.0, 'step_tokens_per_second': 18468.07, 'avg_tokens_per_second': 18468.07}
{'loss': 1.3536, 'grad_norm': 10.11253547668457, 'learning_rate': 5.298133329356934e-06, 'epoch': 0.03, 'num_input_tokens_seen': 675840, 'step': 3, 'step_time_sec': 11.42, 'avg_step_time_sec': 11.42, 'time_to_completion_sec': 79.94, 'estimated_total_time_sec': 114.19, 'step_peak_memory_allocated_MB': 37229.1, 'step_peak_memory_reserved_MB': 53290.0, 'total_peak_memory_allocated_MB': 38576.72, 'total_peak_memory_reserved_MB': 53290.0, 'step_tokens_per_second': 21705.75, 'avg_tokens_per_second': 20086.53}
{'loss': 1.3473, 'grad_norm': 7.244035243988037, 'learning_rate': 4.5e-06, 'epoch': 0.04, 'num_input_tokens_seen': 864256, 'step': 4, 'step_time_sec': 9.73, 'avg_step_time_sec': 10.85, 'time_to_completion_sec': 65.13, 'estimated_total_time_sec': 108.55, 'step_peak_memory_allocated_MB': 27604.61, 'step_peak_memory_reserved_MB': 53666.0, 'total_peak_memory_allocated_MB': 38576.72, 'total_peak_memory_reserved_MB': 53666.0, 'step_tokens_per_second': 19372.12, 'avg_tokens_per_second': 19873.16}
{'loss': 1.1659, 'grad_norm': 3.845432996749878, 'learning_rate': 3.5209445330007917e-06, 'epoch': 0.05, 'num_input_tokens_seen': 1085440, 'step': 5, 'step_time_sec': 11.4, 'avg_step_time_sec': 10.99, 'time_to_completion_sec': 54.96, 'estimated_total_time_sec': 109.91, 'step_peak_memory_allocated_MB': 34630.23, 'step_peak_memory_reserved_MB': 53666.0, 'total_peak_memory_allocated_MB': 38576.72, 'total_peak_memory_reserved_MB': 53666.0, 'step_tokens_per_second': 19401.89, 'avg_tokens_per_second': 19750.96}
{'loss': 1.1883, 'grad_norm': 3.6395351886749268, 'learning_rate': 2.4790554669992093e-06, 'epoch': 0.07, 'num_input_tokens_seen': 1257472, 'step': 6, 'step_time_sec': 7.44, 'avg_step_time_sec': 10.28, 'time_to_completion_sec': 41.13, 'estimated_total_time_sec': 102.82, 'step_peak_memory_allocated_MB': 27604.61, 'step_peak_memory_reserved_MB': 53666.0, 'total_peak_memory_allocated_MB': 38576.72, 'total_peak_memory_reserved_MB': 53666.0, 'step_tokens_per_second': 23113.48, 'avg_tokens_per_second': 20237.79}
{'loss': 1.1453, 'grad_norm': 2.9888062477111816, 'learning_rate': 1.5000000000000007e-06, 'epoch': 0.08, 'num_input_tokens_seen': 1486848, 'step': 7, 'step_time_sec': 11.46, 'avg_step_time_sec': 10.48, 'time_to_completion_sec': 31.43, 'estimated_total_time_sec': 104.78, 'step_peak_memory_allocated_MB': 42812.34, 'step_peak_memory_reserved_MB': 70052.0, 'total_peak_memory_allocated_MB': 42812.34, 'total_peak_memory_reserved_MB': 70052.0, 'step_tokens_per_second': 20012.79, 'avg_tokens_per_second': 20196.77}
{'loss': 1.1608, 'grad_norm': 2.8821871280670166, 'learning_rate': 7.018666706430663e-07, 'epoch': 0.09, 'num_input_tokens_seen': 1730560, 'step': 8, 'step_time_sec': 11.43, 'avg_step_time_sec': 10.61, 'time_to_completion_sec': 21.23, 'estimated_total_time_sec': 106.14, 'step_peak_memory_allocated_MB': 35913.6, 'step_peak_memory_reserved_MB': 70052.0, 'total_peak_memory_allocated_MB': 42812.34, 'total_peak_memory_reserved_MB': 70052.0, 'step_tokens_per_second': 21329.13, 'avg_tokens_per_second': 20370.92}
{'loss': 1.1508, 'grad_norm': 2.8226735591888428, 'learning_rate': 1.8092213764227505e-07, 'epoch': 0.1, 'num_input_tokens_seen': 1929216, 'step': 9, 'step_time_sec': 9.32, 'avg_step_time_sec': 10.45, 'time_to_completion_sec': 10.45, 'estimated_total_time_sec': 104.52, 'step_peak_memory_allocated_MB': 34630.23, 'step_peak_memory_reserved_MB': 70052.0, 'total_peak_memory_allocated_MB': 42812.34, 'total_peak_memory_reserved_MB': 70052.0, 'step_tokens_per_second': 21308.12, 'avg_tokens_per_second': 20475.41}
{'loss': 1.1495, 'grad_norm': 2.6880812644958496, 'learning_rate': 0.0, 'epoch': 0.11, 'num_input_tokens_seen': 2154496, 'step': 10, 'step_time_sec': 11.43, 'avg_step_time_sec': 10.56, 'time_to_completion_sec': 0.0, 'estimated_total_time_sec': 105.61, 'step_peak_memory_allocated_MB': 41368.34, 'step_peak_memory_reserved_MB': 70052.0, 'total_peak_memory_allocated_MB': 42812.34, 'total_peak_memory_reserved_MB': 70052.0, 'step_tokens_per_second': 19708.56, 'avg_tokens_per_second': 20383.19}
{'train_runtime': 108.2101, 'train_samples_per_second': 47.315, 'train_steps_per_second': 0.092, 'train_loss': 1.244506585597992, 'epoch': 0.11, 'num_input_tokens_seen': 2154496, 'step': 10, 'step_time_sec': 11.43, 'avg_step_time_sec': 10.56, 'time_to_completion_sec': 0.0, 'estimated_total_time_sec': 105.61, 'step_peak_memory_allocated_MB': 41368.34, 'step_peak_memory_reserved_MB': 70052.0, 'total_peak_memory_allocated_MB': 42812.34, 'total_peak_memory_reserved_MB': 70052.0, 'step_tokens_per_second': 19708.56, 'avg_tokens_per_second': 20383.19}
