********** Post-Init Instance Patching ***********
********** Post-Init Instance Patching ***********
********** Post-Init Instance Patching ***********
********** Post-Init Instance Patching ***********
apply_liger_kernel_to_phi3 args
True False True True True
Got here phi3!
apply_liger_kernel_to_phi3 args
True False True True True
Got here phi3!
apply_liger_kernel_to_phi3 args
True False True True True
Got here phi3!
apply_liger_kernel_to_phi3 args
True False True True True
Got here phi3!
{'loss': 36.3897, 'grad_norm': 2990865.5, 'learning_rate': 6e-06, 'epoch': 0.01, 'num_input_tokens_seen': 190464}
{'loss': 36.0009, 'grad_norm': 3590213.0, 'learning_rate': 5.819077862357725e-06, 'epoch': 0.02, 'num_input_tokens_seen': 444416, 'step': 2, 'step_time_sec': 12.94, 'avg_step_time_sec': 12.94, 'time_to_completion_sec': 103.55, 'estimated_total_time_sec': 129.43, 'step_peak_memory_allocated_MB': 48663.26, 'step_peak_memory_reserved_MB': 75352.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75352.0, 'step_tokens_per_second': 19620.18, 'avg_tokens_per_second': 19620.18}
{'loss': 35.238, 'grad_norm': 3604828.5, 'learning_rate': 5.298133329356934e-06, 'epoch': 0.03, 'num_input_tokens_seen': 647168, 'step': 3, 'step_time_sec': 11.49, 'avg_step_time_sec': 12.21, 'time_to_completion_sec': 85.5, 'estimated_total_time_sec': 122.14, 'step_peak_memory_allocated_MB': 41684.18, 'step_peak_memory_reserved_MB': 75352.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75352.0, 'step_tokens_per_second': 17653.08, 'avg_tokens_per_second': 18695.34}
{'loss': 34.378, 'grad_norm': 3173310.0, 'learning_rate': 4.5e-06, 'epoch': 0.04, 'num_input_tokens_seen': 856064, 'step': 4, 'step_time_sec': 10.86, 'avg_step_time_sec': 11.76, 'time_to_completion_sec': 70.58, 'estimated_total_time_sec': 117.64, 'step_peak_memory_allocated_MB': 35871.72, 'step_peak_memory_reserved_MB': 75728.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75728.0, 'step_tokens_per_second': 19230.43, 'avg_tokens_per_second': 18860.04}
{'loss': 32.7849, 'grad_norm': 4689778.0, 'learning_rate': 3.5209445330007917e-06, 'epoch': 0.05, 'num_input_tokens_seen': 1079296, 'step': 5, 'step_time_sec': 10.46, 'avg_step_time_sec': 11.44, 'time_to_completion_sec': 57.19, 'estimated_total_time_sec': 114.38, 'step_peak_memory_allocated_MB': 42847.05, 'step_peak_memory_reserved_MB': 75728.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75728.0, 'step_tokens_per_second': 21339.04, 'avg_tokens_per_second': 19426.85}
{'loss': 31.5698, 'grad_norm': 3293662.75, 'learning_rate': 2.4790554669992093e-06, 'epoch': 0.07, 'num_input_tokens_seen': 1312768, 'step': 6, 'step_time_sec': 12.7, 'avg_step_time_sec': 11.69, 'time_to_completion_sec': 46.76, 'estimated_total_time_sec': 116.91, 'step_peak_memory_allocated_MB': 48663.26, 'step_peak_memory_reserved_MB': 75728.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75728.0, 'step_tokens_per_second': 18380.72, 'avg_tokens_per_second': 19199.53}
{'loss': 29.8733, 'grad_norm': 5989155.5, 'learning_rate': 1.5000000000000007e-06, 'epoch': 0.08, 'num_input_tokens_seen': 1517568, 'step': 7, 'step_time_sec': 9.63, 'avg_step_time_sec': 11.35, 'time_to_completion_sec': 34.04, 'estimated_total_time_sec': 113.47, 'step_peak_memory_allocated_MB': 41684.18, 'step_peak_memory_reserved_MB': 75728.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75728.0, 'step_tokens_per_second': 21271.29, 'avg_tokens_per_second': 19492.51}
{'loss': 28.0655, 'grad_norm': 5165983.5, 'learning_rate': 7.018666706430663e-07, 'epoch': 0.09, 'num_input_tokens_seen': 1736704, 'step': 8, 'step_time_sec': 12.56, 'avg_step_time_sec': 11.52, 'time_to_completion_sec': 23.04, 'estimated_total_time_sec': 115.2, 'step_peak_memory_allocated_MB': 30062.5, 'step_peak_memory_reserved_MB': 75728.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75728.0, 'step_tokens_per_second': 17449.5, 'avg_tokens_per_second': 19174.35}
{'loss': 26.7943, 'grad_norm': 4714392.5, 'learning_rate': 1.8092213764227505e-07, 'epoch': 0.1, 'num_input_tokens_seen': 1923072, 'step': 9, 'step_time_sec': 11.32, 'avg_step_time_sec': 11.49, 'time_to_completion_sec': 11.49, 'estimated_total_time_sec': 114.95, 'step_peak_memory_allocated_MB': 39358.82, 'step_peak_memory_reserved_MB': 75728.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75728.0, 'step_tokens_per_second': 16465.25, 'avg_tokens_per_second': 18840.9}
{'loss': 26.316, 'grad_norm': 2581003.5, 'learning_rate': 0.0, 'epoch': 0.11, 'num_input_tokens_seen': 2162688, 'step': 10, 'step_time_sec': 12.27, 'avg_step_time_sec': 11.58, 'time_to_completion_sec': 0.0, 'estimated_total_time_sec': 115.81, 'step_peak_memory_allocated_MB': 48663.26, 'step_peak_memory_reserved_MB': 75728.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75728.0, 'step_tokens_per_second': 19527.33, 'avg_tokens_per_second': 18921.72}
{'train_runtime': 116.8073, 'train_samples_per_second': 43.833, 'train_steps_per_second': 0.086, 'train_loss': 31.741040420532226, 'epoch': 0.11, 'num_input_tokens_seen': 2162688, 'step': 10, 'step_time_sec': 12.27, 'avg_step_time_sec': 11.58, 'time_to_completion_sec': 0.0, 'estimated_total_time_sec': 115.81, 'step_peak_memory_allocated_MB': 48663.26, 'step_peak_memory_reserved_MB': 75728.0, 'total_peak_memory_allocated_MB': 48663.26, 'total_peak_memory_reserved_MB': 75728.0, 'step_tokens_per_second': 19527.33, 'avg_tokens_per_second': 18921.72}
